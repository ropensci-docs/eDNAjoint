<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Specify and fit joint model using count data from traditional surveys and eDNA qPCR data — jointModel • eDNAjoint</title><!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specify and fit joint model using count data from traditional surveys and eDNA qPCR data — jointModel"><meta name="description" content="This function implements a Bayesian model that integrates data from paired
eDNA and traditional surveys, as described in Keller et al. (2022)
&amp;lt;doi.org/10.1002/eap.2561&amp;gt;. The model estimates parameters including
the expected species catch rate and the probability of false positive eDNA
detection. This function allows for optional model variations, like inclusion
of site-level covariates that scale the sensitivity of eDNA sampling relative
to traditional sampling, as well as estimation of gear scaling coefficients
that scales the relative catchability of multiple traditional gear types.
Model is implemented using Bayesian inference using the rstan package,
which uses Hamiltonian Monte Carlo to simulate the posterior distributions.
See more examples in the
Package
Vignette."><meta property="og:description" content="This function implements a Bayesian model that integrates data from paired
eDNA and traditional surveys, as described in Keller et al. (2022)
&amp;lt;doi.org/10.1002/eap.2561&amp;gt;. The model estimates parameters including
the expected species catch rate and the probability of false positive eDNA
detection. This function allows for optional model variations, like inclusion
of site-level covariates that scale the sensitivity of eDNA sampling relative
to traditional sampling, as well as estimation of gear scaling coefficients
that scales the relative catchability of multiple traditional gear types.
Model is implemented using Bayesian inference using the rstan package,
which uses Hamiltonian Monte Carlo to simulate the posterior distributions.
See more examples in the
Package
Vignette."><meta property="og:image" content="https://docs.ropensci.org/eDNAjoint/logo.png"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css"><script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">eDNAjoint</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/eDNAjoint/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Specify and fit joint model using count data from traditional surveys and eDNA qPCR data</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/eDNAjoint/blob/master/R/jointModel.R" class="external-link"><code>R/jointModel.R</code></a></small>
      <div class="d-none name"><code>jointModel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements a Bayesian model that integrates data from paired
eDNA and traditional surveys, as described in Keller et al. (2022)
&lt;doi.org/10.1002/eap.2561&gt;. The model estimates parameters including
the expected species catch rate and the probability of false positive eDNA
detection. This function allows for optional model variations, like inclusion
of site-level covariates that scale the sensitivity of eDNA sampling relative
to traditional sampling, as well as estimation of gear scaling coefficients
that scales the relative catchability of multiple traditional gear types.
Model is implemented using Bayesian inference using the <code>rstan</code> package,
which uses Hamiltonian Monte Carlo to simulate the posterior distributions.
See more examples in the
<a href="https://bookdown.org/abigailkeller/eDNAjoint_vignette/" class="external-link">Package
Vignette</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">jointModel</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  cov <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  p10priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  q <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  phipriors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  multicore <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  initial_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.chain <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  n.iter.burn <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  n.iter.sample <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A list containing data necessary for model fitting. Valid tags
are <code>qPCR.N</code>, <code>qPCR.K</code>, <code>count</code>, <code>count.type</code>, and <code>site.cov</code>. <code>qPCR.N</code> and
<code>qPCR.K</code> are matrices or data frames with first dimension equal to the
number of sites (i) and second dimension equal to the maximum number of
eDNA samples at a given site (m). <code>qPCR.N</code> contains the total number of
qPCR replicates per site and eDNA sample, and <code>qPCR.K</code> contains the total
number of positive qPCR detections per site and eDNA sample. <code>count</code> is a
matrix or data frame of traditional survey count data, with first
dimension equal to the number of sites (i) and second dimension equal to
the maximum number of traditional survey replicates at a given site (j).
<code>count.type</code> is an optional matrix or data frame of integers indicating
gear type used in corresponding count data, with first dimension equal to
the number of sites (i) and second dimension equal to the maximum number
of traditional survey replicates at a given site. Values should be
integers beginning with 1 (referring to the first gear type) to n (last
gear type). <code>site.cov</code> is an optional matrix or data frame of site-level
covariate data, with first dimension equal to the number of sites (i).
<code>site.cov</code> should include informative column names. Empty cells should
be NA and will be removed during processing. Sites, i, should be consistent
in all qPCR, count, and site covariate data.</p></dd>


<dt id="arg-cov">cov<a class="anchor" aria-label="anchor" href="#arg-cov"></a></dt>
<dd><p>A character vector indicating the site-level covariates to include
in the model. Default value is NULL.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>The distribution class used to model traditional survey count
data. Options include poisson ('poisson'), negative binomial ('negbin'),
and gamma ('gamma'). Default value is 'poisson'.</p></dd>


<dt id="arg-p-priors">p10priors<a class="anchor" aria-label="anchor" href="#arg-p-priors"></a></dt>
<dd><p>A numeric vector indicating beta distribution
hyperparameters (alpha, beta) used as the prior distribution for the eDNA
false positive probability (p10). Default vector is c(1,20).</p></dd>


<dt id="arg-q">q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>A logical value indicating whether to estimate gear scaling
coefficients, q, for traditional survey gear types (TRUE) or to not
estimate gear scaling coefficients, q, for traditional survey gear types
(FALSE). Default value is FALSE.</p></dd>


<dt id="arg-phipriors">phipriors<a class="anchor" aria-label="anchor" href="#arg-phipriors"></a></dt>
<dd><p>A numeric vector indicating gamma distribution
hyperparameters (shape, rate) used as the prior distribution for phi, the
overdispersion in the negative binomial distribution for traditional survey
gear data. Used when family = 'negbin.' If family = 'negbin', then
default vector is c(0.25,0.25), otherwise, default is NULL.</p></dd>


<dt id="arg-multicore">multicore<a class="anchor" aria-label="anchor" href="#arg-multicore"></a></dt>
<dd><p>A logical value indicating whether to parallelize chains
with multiple cores. Default is FALSE.</p></dd>


<dt id="arg-initial-values">initial_values<a class="anchor" aria-label="anchor" href="#arg-initial-values"></a></dt>
<dd><p>A list of lists of initial values to use in MCMC. The
length should equal the number of MCMC chains. Initial values can be
provided for parameters: beta, p10 (log-scale), mu, q, alpha. If no
initial values are provided, default random values are drawn.</p></dd>


<dt id="arg-n-chain">n.chain<a class="anchor" aria-label="anchor" href="#arg-n-chain"></a></dt>
<dd><p>Number of MCMC chains. Default value is 4.</p></dd>


<dt id="arg-n-iter-burn">n.iter.burn<a class="anchor" aria-label="anchor" href="#arg-n-iter-burn"></a></dt>
<dd><p>Number of warm-up MCMC iterations. Default value is 500.</p></dd>


<dt id="arg-n-iter-sample">n.iter.sample<a class="anchor" aria-label="anchor" href="#arg-n-iter-sample"></a></dt>
<dd><p>Number of sampling MCMC iterations. Default value is
2500.</p></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>A positive integer specifying the period for saving samples.
Default value is 1.</p></dd>


<dt id="arg-adapt-delta">adapt_delta<a class="anchor" aria-label="anchor" href="#arg-adapt-delta"></a></dt>
<dd><p>Numeric value between 0 and 1 indicating target average
acceptance probability used in <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling</a></code>. Default value is 0.9.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical value controlling the verbosity of output (i.e.,
warnings, messages, progress bar). Default is TRUE.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>A positive integer seed used for random number generation in
MCMC. Default is NULL, which means the seed is generated from 1 to the
maximum integer supported by R.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of:</p><ul><li><p>a model object of class <code>stanfit</code> returned by <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling</a></code></p></li>
<li><p>initial values used in MCMC</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Before fitting the model, this function checks to ensure that the
model specification is possible given the data files. These checks include:</p><ul><li><p>All tags in data are valid (i.e., include qPCR.N, qPCR.K, count,
count.type, and site.cov).</p></li>
<li><p>Dimensions of qPCR.N and qPCR.K are equal, and dimensions of count and
count.type are equal (if count.type provided).</p></li>
<li><p>Number of sites in qPCR and count data are equal.</p></li>
<li><p>All data are numeric (i.e., integer or NA).</p></li>
<li><p>Empty data cells (NA) match in qPCR.N and qPCR.K and in count and
count.type.</p></li>
<li><p>family is either 'poisson', 'negbin', or 'gamma'.</p></li>
<li><p>p10priors and phipriors (if used) is a vector of two numeric values.</p></li>
<li><p>site.cov has same number of rows as qPCR.N and count, if present</p></li>
<li><p>site.cov is numeric, if present</p></li>
<li><p>cov values match column names in site.cov, if present</p></li>
</ul><p>If any of these checks fail, the function returns an error message.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Ex. 1: Implementing the joint model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gobyData</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine data in list</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gobyData</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "qPCR.N"   "qPCR.K"   "count"    "site.cov"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that the surveyed sites (rows) should match in all data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gobyData</span><span class="op">$</span><span class="va">qPCR.N</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 39</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gobyData</span><span class="op">$</span><span class="va">count</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 39</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a basic model with paired eDNA and traditional survey data.</span></span></span>
<span class="r-in"><span><span class="co"># Count data is modeled using a poisson distribution.</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">jointModel</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gobyData</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, p10priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  multicore <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_pois' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 4.8e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.48 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 0.954 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                1.728 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                2.682 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_pois' NOW (CHAIN 2).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Gradient evaluation took 4.4e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.44 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:  Elapsed Time: 0.982 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                1.639 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                2.621 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_pois' NOW (CHAIN 3).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Gradient evaluation took 4.4e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.44 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3:  Elapsed Time: 1.007 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3:                1.797 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3:                2.804 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_pois' NOW (CHAIN 4).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Gradient evaluation took 4.5e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.45 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4:  Elapsed Time: 0.894 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4:                1.725 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4:                2.619 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Refer to the eDNAjoint guide for visualization tips:  https://ednajoint.netlify.app/tips#visualization-tips </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Ex. 2: Implementing the joint model with site-level covariates</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With the same data, fit a model including 'Filter_time' and 'Salinity'</span></span></span>
<span class="r-in"><span><span class="co"># site-level covariates</span></span></span>
<span class="r-in"><span><span class="co"># These covariates will scale the sensitivity of eDNA sampling relative to</span></span></span>
<span class="r-in"><span><span class="co"># traditional surveys</span></span></span>
<span class="r-in"><span><span class="co"># Count data is modeled using a poisson distribution.</span></span></span>
<span class="r-in"><span><span class="va">fit.cov</span> <span class="op">&lt;-</span> <span class="fu">jointModel</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gobyData</span>, cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Filter_time'</span>,<span class="st">'Salinity'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      family <span class="op">=</span> <span class="st">"poisson"</span>, p10priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      multicore <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_cov_pois' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 5.2e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.52 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 0.96 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                1.75 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                2.71 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_cov_pois' NOW (CHAIN 2).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Gradient evaluation took 5.1e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.51 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:  Elapsed Time: 5.15 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                1.751 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                6.901 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_cov_pois' NOW (CHAIN 3).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Gradient evaluation took 5.2e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.52 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3:  Elapsed Time: 0.676 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3:                1.763 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3:                2.439 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_cov_pois' NOW (CHAIN 4).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Gradient evaluation took 4.7e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.47 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4:  Elapsed Time: 0.952 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4:                1.709 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4:                2.661 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Refer to the eDNAjoint guide for visualization tips:  https://ednajoint.netlify.app/tips#visualization-tips </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Ex. 3: Implementing the joint model with multiple traditional gear types</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">greencrabData</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine data in list</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">greencrabData</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "qPCR.N"     "qPCR.K"     "count"      "count.type"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that the surveyed sites (rows) should match in all data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">greencrabData</span><span class="op">$</span><span class="va">qPCR.N</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">greencrabData</span><span class="op">$</span><span class="va">count</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a model estimating a gear scaling coefficient for traditional survey</span></span></span>
<span class="r-in"><span><span class="co"># gear types.</span></span></span>
<span class="r-in"><span><span class="co"># This model does not assume all traditional survey methods have the same</span></span></span>
<span class="r-in"><span><span class="co"># catchability.</span></span></span>
<span class="r-in"><span><span class="co"># Count data is modeled using a negative binomial distribution.</span></span></span>
<span class="r-in"><span><span class="va">fit.q</span> <span class="op">&lt;-</span> <span class="fu">jointModel</span><span class="op">(</span>data <span class="op">=</span> <span class="va">greencrabData</span>, cov <span class="op">=</span> <span class="cn">NULL</span>, family <span class="op">=</span> <span class="st">"negbin"</span>,</span></span>
<span class="r-in"><span>                    p10priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span><span class="op">)</span>, q <span class="op">=</span> <span class="cn">TRUE</span>, phipriors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    multicore <span class="op">=</span> <span class="cn">FALSE</span>, initial_values <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                    n.chain <span class="op">=</span> <span class="fl">4</span>, n.iter.burn <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>                    n.iter.sample <span class="op">=</span> <span class="fl">2500</span>, thin <span class="op">=</span> <span class="fl">1</span>, adapt_delta <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                    verbose <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_catchability_negbin' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0.000283 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.83 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 3.426 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                10.21 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                13.636 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_catchability_negbin' NOW (CHAIN 2).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Gradient evaluation took 0.000325 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 3.25 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:  Elapsed Time: 3.591 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                8.674 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2:                12.265 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_catchability_negbin' NOW (CHAIN 3).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Gradient evaluation took 0.000321 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 3.21 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3:  Elapsed Time: 3.536 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3:                11.201 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3:                14.737 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'joint_binary_catchability_negbin' NOW (CHAIN 4).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Gradient evaluation took 0.000307 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 3.07 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration:    1 / 3000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration:  500 / 3000 [ 16%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration:  501 / 3000 [ 16%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 1000 / 3000 [ 33%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 1500 / 3000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 2000 / 3000 [ 66%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 2500 / 3000 [ 83%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: Iteration: 3000 / 3000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4:  Elapsed Time: 3.407 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4:                10.864 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4:                14.271 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Refer to the eDNAjoint guide for visualization tips:  https://ednajoint.netlify.app/tips#visualization-tips </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>





  </body></html>

